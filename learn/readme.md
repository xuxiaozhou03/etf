# 量化交易学习笔记

## 1. 量化交易简介

量化交易是指利用数学、统计学、计算机科学等方法，通过编写程序自动化地进行金融市场交易。其核心在于用数据和模型驱动决策，减少主观情绪影响，提高交易效率和一致性。

> 本笔记聚焦于 A 股市场的 ETF（交易型开放式指数基金）量化交易。ETF 兼具股票和基金的特性，流动性好、品种丰富，适合多种量化策略实践。

主要特点：

- 数据驱动：依赖历史和实时数据分析。
- 自动化执行：通过算法自动下单和管理仓位。
- 可回测：策略可用历史数据检验有效性。
- 风险可控：可量化和管理风险敞口。

在 A 股市场，ETF 交易具有以下特点：

- 品种多样，覆盖宽基、行业、主题等不同指数。
- 交易机制与股票类似，T+1 结算，无涨跌停限制（部分 ETF 除外）。
- 申购赎回机制可用于套利。
- 适合趋势、套利、轮动等多种量化策略。

## 2. 量化交易的基本流程

量化交易的基本流程通常包括以下几个步骤：

1. 策略研究与开发：

   - 明确交易目标和市场（本笔记以 A 股 ETF 为例）。
   - 设计和开发交易策略。常见的量化策略包括：
     - 趋势跟踪策略：如均线交叉、动量策略，利用价格趋势进行交易。
     - 均值回归策略：如布林带、配对交易，假设价格会回归均值。
     - 套利策略：如跨品种套利、统计套利，利用市场定价偏差获利。
     - 高频交易策略：利用微小价差和市场流动性进行频繁交易。
     - 机器学习策略：用机器学习方法预测市场走势或信号。
   - 策略开发需结合理论、数据分析和实盘可行性。

2. 数据获取与处理：

   - 收集历史和实时市场数据。
     - 数据类型：行情数据（K 线、分笔、Tick）、基本面数据、宏观经济数据、新闻舆情等。
     - 数据源：推荐使用 akshare（开源金融数据接口），可便捷获取 A 股 ETF 的行情、成分、资金流、财务等多类数据。
       - akshare 优势：免费、数据丰富、API 简单，适合量化研究和策略开发。
       - 适用场景：历史行情下载、ETF 列表、成分股、资金流向、财务指标等。
       - 官方文档：https://akshare.akfamily.xyz/
   - 数据清洗：
     - 处理缺失值、异常值、重复数据。
     - 时间对齐、复权处理等。
   - 特征工程：
     - 构造技术指标：如均线（MA）、相对强弱指数（RSI）、移动平均收敛/发散（MACD）、布林带（Bollinger Bands）等。
     - 生成因子：如动量因子（过去 N 日涨跌幅）、波动率因子（历史标准差）、换手率、量价相关性等。
     - 行业/主题特征：ETF 所属行业、主题、宽基/窄基等分类信息。
     - 市场特征：大盘指数涨跌、资金流向、市场情绪指标等。
     - 归一化与标准化：对特征进行归一化（Min-Max）、标准化（Z-score）等处理，消除量纲影响。
     - 特征选择：通过相关性分析、信息量筛选等方法，保留对策略有效的特征。
     - 注意事项：避免未来数据泄露，特征应基于可获得的历史信息构造。
   - 数据质量直接影响策略效果，需保证数据准确、完整、及时。

3. 策略回测：

   - 用历史数据检验策略有效性。
     - 回测流程：设定初始资金、手续费、滑点等参数，模拟策略在历史数据上的买卖过程。
     - 评估指标：
       - 收益类：累计收益率、年化收益率、夏普比率、信息比率等。
       - 风险类：最大回撤、波动率、卡玛比率等。
       - 其他：胜率、盈亏比、换手率等。
   - 注意事项：
     - 防止未来函数、数据泄露等回测偏差。
     - 合理设置滑点、手续费，贴近真实交易环境。
   - 常用回测工具：
     - 推荐使用 backtrader：功能强大、文档丰富，适合个人和研究者。

4. 仿真交易（Paper Trading）：

   - 在本地自定义实现仿真交易系统，检验策略在准实时环境下的表现。
   - 目的：验证策略在历史回测之外的表现，发现实盘可能遇到的问题。
   - 基本思路：
     - 通过定时任务或轮询方式，获取最新行情（如用 akshare 获取 ETF 分时/日线数据）。
     - 策略根据最新数据生成买卖信号。
     - 用本地 Python 程序模拟资金、持仓、下单、成交、手续费等环节。
     - 记录每笔交易、资金变化、持仓变化等日志，便于复盘和分析。
   - 注意事项：
     - 仿真环境与真实市场仍有差异（如撮合延迟、流动性等），但可最大程度贴近实盘流程。

5. 风险管理（针对仿真交易）：

   - 风险管理与监控：
     - 实时监控策略表现和风险敞口。
       - 风险类型：市场风险、流动性风险、系统风险、操作风险等。
     - 常用风险管理方法：
       - 仓位控制：限制单笔、单品种和整体资金的最大投入比例。
       - 止损止盈：设置止损线和止盈线，及时止损或锁定利润。
       - 分散投资：多策略、多品种分散降低单一风险。
       - 杠杆管理：合理使用杠杆，防止爆仓。
     - 监控手段：
       - 实时监控净值、回撤、持仓、订单等关键指标。
       - 自动预警和风控触发机制。
     - 注意事项：
       - 定期复盘和评估策略表现，及时调整或停止表现不佳的策略。
       - 保证交易系统稳定性和数据安全。
   - 备注：本节风险管理内容主要针对仿真交易流程。

每一步都需要结合编程、数据分析和金融知识，形成完整的量化交易闭环。
